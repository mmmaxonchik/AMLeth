Сопутствующий опыт работы
Стремясь смягчить незаконную деятельность в сети Ethereum путем выявления схем Понци, развернутых в виде смарт-контрактов, Чен, Чжэн, Нгай, Чжэн и Чжоу (2019) классифицировали учетные записи на основе их кода операции (Opcode) с использованием контролируемых алгоритмов обучения. После настройки параметров превосходный Random Forest смог классифицировать 305 из 394 выявленных схем SmartPonzi с вероятностной достоверностью более 90%, принимая во внимание, что они могут включать в себя экспериментально развернутые контракты.
Анализируя 200 смарт-контрактов, «CREATE» оказался наименее используемым кодом операции и появился только в 20 из них. Это имеет смысл, поскольку вышеупомянутый код операции используется при создании новой учетной записи вместе с некоторым связанным с ней кодом, а у схем Понци практически нет причин создавать новые учетные записи. Учитывая полноту и точность, достигнутые их моделью, авторы подсчитали, что в сети Ethereum доступно более 500 схем Smart-Ponzi.
Чтобы обнаружить мошенническую активность в сети Ethereum, Оканэ (2018) изучил транзакции, совершенные 4000 мошенническими объектами, доступными в Etherscamdb, а также токены и адреса обмена. Мошеннические адреса, подпадающие под категорию фишингового мошенничества, были либо отправителем, либо получателем транзакции. Самым распространенным оказался сайт OmiseGo, запрашивающий секретные ключи. Менее чем через 36 часов, между 17:50. 9 и 23:30. 10 января пострадало 74 адреса.
Используя анализ главных компонент (PCA), K-средние и случайный лес, 13 кластеров дали максимальный индекс Дэвиса-Булдина 81,2%. Девять признаков со средним снижением Джини менее 600 были сохранены. Функция «toAcc», определяющая идентификатор учетной записи, отправившей эфир, была определена как наиболее важная функция. Используя эти результаты для обнаружения аномалий в своих данных, было обнаружено 5 выбросов на основе их евклидова расстояния от центров кластеров.

Набор данных учетной записи Ethereum
Набор данных был получен путем объединения двух источников; Etherscamdb и локальный клиент Geth, подключенные к сети Ethereum для мошеннических и обычных учетных записей соответственно.
Учетные записи были отмечены сообществом Ethereum за незаконное поведение в ряде случаев, некоторые из которых включают в себя (i) попытку имитировать адреса других контрактов, предоставляющих токены, (ii) мошеннические лотереи, (iii) фальшивые первоначальные предложения монет (ICO), ( iv) имитация других пользователей, (v) схемы Понци, (vi) фишинговые и (vii) зеркальные веб-сайты.
Все незаконные учетные записи, перечисленные 17 апреля 2019 года, были собраны из Etherscamdb4, общедоступного набора данных, содержащего предоставленные сообществом идентификаторы учетных записей Ethereum, которые, как считается, осуществляли незаконную деятельность, посредством запроса GET, анализируя адреса, доступные в возвращенном объекте JSON. Всего было приобретено 2179 мошеннических аккаунтов. На этапе подготовки данных не требовалось никакой предварительной обработки, поскольку не требовалось никаких пропущенных значений и преобразований. Полный список атрибутов указан в Приложении. Используя функциональный инструмент, разработанный Соколовской (2018), мы случайным образом выбрали 3000 обычных учетных записей, которые проводили транзакции в диапазоне блоков 3 800 000 и 3 805 000,5. После фильтрации неуникальных учетных записей окончательное количество составило 2 502 уникальных. Эти учетные записи были активны в середине июля 2017 года — в период, когда наблюдался рост использования сети Ethereum. Все учетные записи были сопоставлены с идентификаторами незаконных учетных записей, чтобы гарантировать, что ни одна из полученных учетных записей не осуществляла задокументированную незаконную деятельность.
Все обычные и незаконные идентификаторы учетных записей, в результате чего в общей сложности получилось 4681 учетная запись, затем были переданы в интерфейс прикладного программирования (API) Etherscan для получения всех соответствующих транзакций, в которых участвовала учетная запись. API поддерживал извлечение последних 10 000 транзакций, проведенных осуществляется с помощью контрактной учетной записи ERC20 (CA) (CA, соответствующей стандарту интерфейса ERC20) или внешней учетной записи (EOA). API имеет следующую структуру для (1) обычных транзакций и (2) внутренних транзакций соответственно;
В качестве адреса параметра API был установлен 4681 идентификатор учетной записи, для которых были получены соответствующие транзакции для всех учетных записей. Характеристики были извлечены из всех транзакций, выполненных учетной записью, прежде чем они были добавлены в файл CSV для классификации модели.
Самая простая форма транзакций в сети Ethereum — между EOA. Эти выполненные транзакции включают передачу эфира от отправителя получателю (Цао, Чжан, Лю, Чжан и Нери, 2019). Другие возможные транзакции могут включать вклады в краудсейл контрактных токенов в обмен на определенное количество соответствующих токенов (Rouhani & Deters, 2017). В этом отношении передаваемое значение в большинстве случаев равно 0 и называется функциями, для которых конечный пользователь вызывает функцию контракта «претензии» для сбора причитающихся токенов.

Обычные транзакции содержат поле «ISERROR», которое определяет, была ли транзакция успешной или нет. Неудачная транзакция может быть вызвана многими возможными причинами, некоторые из которых включают отсутствие необходимых средств, превышение лимита газа или неверный адрес счета получателя (Sturm, Schnig, Szalanczi & Jablonski, 2019). Для целей данного исследования нас интересуют только те транзакции, которые были успешно выполнены путем установления того, что поле «ISERROR» установлено в 0, и отбрасывания остальных. Для этих успешных транзакций мы получаем соответствующие поля, указанные в таблице 1, чтобы выполнить извлечение признаков.
Транзакции ERC20 связаны исключительно с передачей токенов, которые поддерживают стандарт интерфейса ERC20 или подпадают под него (Ikeda & Hamid, 2018). Следовательно, передаваемый токен должен поддерживать эти стандарты, и только тогда эти токены будут указаны как передаваемые токены. В отличие от «обычных транзакций», любые перечисленные транзакции были успешными, и поэтому фильтрация транзакций не требуется. Получение полей транзакции, упомянутых в таблице 2, для каждой транзакции позволило извлекать функции для предоставленных идентификаторов учетных записей.
С использованием собранных транзакций в общей сложности было извлечено 42 функции для каждой учетной записи.6 Небольшое подмножество извлеченных функций было похоже на те, которые были получены в аналогичной работе с использованием графового анализа (Chen, Zhu и др., 2018; Hirshman, Huang, & Macke, 2013). Извлечение функций осуществлялось совместно с API запроса транзакций Etherscan; создание соответствующих полей для каждой учетной записи. Мы сделали извлеченный набор данных и код общедоступным.

Визуализация данных и алгоритмы ML
Рис. 1 и 2, соответствующие нелинейному преобразованию, примененному к исходному пространству объектов с использованием t-SNE, были сгенерированы относительно метки класса учетной записи (нормальной или незаконной), показывающей 2D и 3D графики t-SNE соответственно.
Для фото:
Двумерная диаграмма рассеяния после преобразования t-SNE относительно класса счета. Красные и синие точки данных обозначают обычные и незаконные счета соответственно. (Для интерпретации ссылок на цвет в легенде к рисунку читатель отсылается к веб-версии этой статьи.)

На двумерной диаграмме рассеяния на рис. 1 мы отмечаем, что несколько различимых кластеров из обоих классов, в частности, три красных кластера, доступные в нижней правой части графика. Тем не менее, по-прежнему существует существенное перекрытие точек данных разных классов. На рис. 2 представлена трехмерная диаграмма рассеяния с наклоном 30°. На рис. 2 представлено альтернативное представление кластеров «незаконных» счетов, которые показаны на рис. 1. Эти два рисунка подчеркивают необходимость использования методов машинного обучения, которые помогут различить два двоичных класса, обеспечивая при этом визуальное представление имеющихся данных. Затем последовала реализация модели классификации XGBoost, включающая последовательный трехэтапный процесс; (i) объявление модели вместе со всеми соответствующими параметрами, которые необходимо учитывать, (ii) обучение классификатора на обучающем наборе и (iii) прогнозирование на тестовых данных с использованием модели, обученной в предыдущем шаге. Для оценки эффективности модели использовалась перекрестная проверка.
Мы оценили следующие три основных параметра XGBoost с помощью поиска по сетке; (i) скорость обучения, (ii) количество оценщиков (n_estimators) и (iii) максимальная глубина (max_eep).
Наилучшие параметры были определены с использованием кривой рабочих характеристик приемника (ROC), которая представляет собой показатель площади под кривой (AUC) (Брэдли, 1997). Классификаторы на этапе прогнозирования создают измеримое количество экземпляров, которым присвоен правильный и неправильный класс. Обычно они документируются в виде матрицы путаницы; с указанием количества истинных положительных результатов (TP), истинных отрицательных результатов (TN), ложных положительных результатов (FP) и ложных отрицательных результатов (FN). Хотя эти показатели служат показателем эффективности модели, можно сформулировать более значимые показатели, чтобы подчеркнуть эффективность модели в конкретных сценариях. Чувствительность, специфичность и точность входят в число этих показателей наряду с ценой неправильной классификации.
Точность — один из простейших показателей определения эффективности модели классификации. Проще говоря, это количество правильных прогнозов относительно всех доступных тестируемых примеров.
